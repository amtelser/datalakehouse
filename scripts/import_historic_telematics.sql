INSERT INTO nessie.telematics.gps_reports
SELECT
  t.report_type,
  t.tenant,
  t.provider,
  t."model",
  t.firmware,
  t.device_id,
  t.alert_type,
  CAST(
    COALESCE(
      regexp_extract(CAST(t.coordinates AS varchar),      '\\(([-0-9\\.]+),([-0-9\\.]+)\\)', 2),
      regexp_extract(CAST(t.proxy_coordinates AS varchar),'\\(([-0-9\\.]+),([-0-9\\.]+)\\)', 2)
    ) AS double
  ) AS latitude,
  CAST(
    COALESCE(
      regexp_extract(CAST(t.coordinates AS varchar),      '\\(([-0-9\\.]+),([-0-9\\.]+)\\)', 1),
      regexp_extract(CAST(t.proxy_coordinates AS varchar),'\\(([-0-9\\.]+),([-0-9\\.]+)\\)', 1)
    ) AS double
  ) AS longitude,
  COALESCE(t.gps_fixed, t.proxy_gps_fixed, false) AS gps_fixed,
  CAST(t.gps_epoch      AS timestamp(3) with time zone) AS gps_epoch,
  CAST(t.satellites     AS bigint)                      AS satellites,
  CAST(t.speed_kmh      AS double)                      AS speed_kmh,
  t.heading,
  CAST(t.odometer_meters AS bigint)                     AS odometer_meters,
  t.engine_on,
  t.vehicle_battery_voltage,
  t.backup_battery_voltage,
  CAST(t.received_epoch AS timestamp(3) with time zone) AS received_epoch,
  CAST(t.decoded_epoch  AS timestamp(3) with time zone) AS decoded_epoch,
  t.correlation_id,
  CAST(bitwise_and(crc32(to_utf8(t.device_id)), BIGINT '255') AS integer) AS device_id_bucket,
  CAST((t.received_epoch AT TIME ZONE 'America/Mexico_City') AS date) AS received_day,
  CAST(extract(HOUR FROM (t.received_epoch AT TIME ZONE 'America/Mexico_City')) AS integer) AS received_hour,
  CAST((t.gps_epoch      AT TIME ZONE 'America/Mexico_City') AS date) AS gps_day
FROM postgres.public.telematics_real_time t
WHERE t.device_id in ()
  AND t.report_type IN ('STATUS','ALERT')
  AND t.gps_fixed = true
  AND t.received_epoch BETWEEN
        from_iso8601_timestamp('2025-08-16T00:00:00-06:00')
    AND from_iso8601_timestamp('2025-08-31T23:59:59-06:00')
order by received_epoch asc;


-- producto = 'Tractos Brokers'  
-- '3605666','4326818','4500571','4712510','4730765','4737412','4749134','4754525','4755746','4757203','4879134','4883094','4889991','4900887','4901114','4905387','4905989','4924902','4925549','4938677','4944687','4945154','4951401','4951447','4951836','4952330','4955045','4955179','4955294','4975395','4978383','4979920','4980227','4980795','4981183','4985620','4986726','4986878','4986902','4987169','4990303','4990817','4992453','4992842','4993258','4995256','4997403','4997537','4997740','4997810','4999951','5002234','5003428','5003589','5004047','5004153','5004445','5004515','5004773','5005134','5005143','5005222','5005301','5005417','5005657','5006106','5012806','5015195','5016909','5018767','5019331','5019632','5020780','5025299','5028296','5036596','5049396','5053210','5057234','5064988','5066658','5067134','5105416','5112586','5115909','5117208','5117536','5154883','5157251','5162305','5170632','5177972','5200687','5236488','5261068','5261086','5261509','5273504','5281080','5282344','5342141','5348686','5359460','5380406','5385216','5434868','5435511','5446614','5496859','5509588','5511723','5511787','5512661','5513156','5517268','5537855','5539136','5540877','5603802','5608117','5620395','5623541','5635829','5636305','5706400','5712641','5717026','5721719','5722912','5723009','5724202','7708533','7709122','5746505','5747230','5747504','5748840','5749876','5758467','5759767','5760286','5763025','5765740','5766156','5766624','5766800','5767243','5769898','5770256','5770308','5776533','5832431','5834280','5838578','5840722','5840926','5842331','5842562','5843297','5845277','5845736','5848663','7709855','7710553','7710548','7710288','7710590','7711174','7710797','7711083','7710144','5876709','5882603','5888847','7712590','5914054','5967384','5999356','6092447','6097488','7718396','7719471','7718890','6115395','6116905','6122483','6122517','6129103','6130871','6132082','6132240','6135070','6183615','6189433','7721628','7722006','7723131','7720724','7723665','7723885','7723516','7724924','7724921','7724927','7724905','7725463','7725454','7726822','7724750','7725145','7725160','7724677','7725475','7724572','7726256','7726221','7726250','7727093','6297909','6299420','6301178','7726794','6303893','807700593','807700076','807702380','807702549','807701080','807705070','807705062','807705379','807705641','807705116','807707288','807705353','807704973','807704995','807705046','807705054','807706414','807706210','807706775','807705271','807706297','807706767','807704913','807705955','807705943','807709849','807709067','807707933','807710184','807710980','807711135','807710728','807714915','807715071','807715078','807714842','807714478','807719020','807718992','807717322','807717944','807715522','807717856','807717870','807717860','807717126','807715330','807718314','807716935','807715363','807716580','807716375','807717037','807716593','807718763','807722785','807722778','807720014','807721748','807723886','807720040','807720666','807720685','807719857','807720754','807719674','807721428','807719681','807722902','807722897','807719985','807722561','807722432','807720428','807723576','807722476','807721006','807721012','807721687','807721694','807721740','807726713','807726728','807726144','807726203','807727505','807727958','807727959','807727488','807726923','807726797','807726921','807728038','807728043','807727844','807728034','807728048','807726239','807726313','807726336','807726234','807726236','807727459','807726971','807726999','807726986','807726987','807726995','807727660','807725971','807726108','807726115','807726127','807726112','807727528','807727519','807726125','807727556','807727542','807728240','807728276','807727275','807727614','807727617','807727628','807727605','807727604','807728333','807727876','807728336','807726964','807728340','807726756','807726747','807727263','807727794','807727797','807728357','807728115','807728129','807727302','807727312','807727333','807727351','807726879','807726877','807726836','807726345','807727328','807727321','807726028','807727150','807727136','807726162','807727153','807727691','807726886','807726632','807726618','807726653','807728096','807726665','807726375','807727377','807727369','807726283','807726789','807726770','807726688','807726679','807730524','807731777','807731775','807731826','807730099','807730961','807729893','807729404','807731521','807731519','807728970','807728985','807731515','807729799','807730247','807728500','807728497','807731870','807729977','807731293','807732358','807732239','807732862','807732940','807731947','807733359','807732268','807733791','807733817','807731971','807734042','807731991','807734065','807734112','807734117','807734111','807733587','807732539','807733904','807733175','807733674','807734650','807736646','807735419','807734229','807736737','807735623','807735299','807735318','807736486','807736537','807736899','807737206','807735864','807735868','807735881','807735885','807724775','807724544','807725097','807725399','807740173','807740646','807740549','807742448','807742293','807743340','807744066','807742801','807741493','807741449','807741450','807743867','807742630','807742482','807741248','807741259','807742956','807744283','807742994','807742990','807741403','807741413','807741214','807742742','807741964','807742862','807741287','807741290','807742857','807745306','807744411','807745487','807741522','807744602','7017513','7021783','7021835','7022083','807745816','807747223','807745905','807747354','807748294','807747903','807749232','807749247','807750786','807751344','807753607','807755309','807753883','807752595','807752923','807752464','807754321','807753349','807753992','807752482','807757589','807758363','807757006','807758895','7350320','7408469','7412204','7415885','7419526','7423635','7424041','7444762','807762574','807762029','807762069','807762079','807761789','807761971','807761318','807767475','807766325','807767137','807766445','807766899','807767929','807768346','807767672','807764992','807764994','7580286','7582105','7582309','7582318','7599716','7601321','7603879','7606690','807770653','807771762','807770363','807771111','807773755','807769277','807770213','807770312','807768847','807768855','807779189','807775280','807775437','807775429','807777292','807780266','807780259','807778677','807779043','807725582','807750572','807775791','807777186','807777172','807777714','807779222','511705239','511705627','511705632','511705283','511710059','511707478','511706440','511706761','511707515','511707534','511707716','511708020','511708006','511708484','511705100','511708392','511708991','511705588','511708469','511710281','511710277','511706100','511707486','511709509','511710304','511709669','511709647','511706189','511709310','848003605','848003588','848003930','848004069','848003357','848002628','848004355','848004368','848003501','848002878','848003476','848004042','848004041','848002419','848003375','848003671','848003264','848001620','848001410','848000209','848000432','848000427','848000638','848001916','848001884','848000315','848000328','848000557','848007574','848007368','848008434','848009278','848008390','848008375','848007239','848008876','848008411','848006188','848005112','848006486','848006522','848006519','848006145','848005279','848006377','848006419','848005902','848005496','848005503','848005283','848005293','848005310','848005546','848005945','848005556','848005580','848006180','848010521','848010227','848010219','848010599','848011332','848010944','848011103','848011101','848012891','848013399','848013398','848012445','848013745','848013248','848013977','848013728','848013950','848012375','848012926','848012831','848014664','848014965','848015097','848014566','848015184','848014518','848014505','848015015','848015958','848014683','848015114','848015700','848014899','848015720','848015710','848017233','848017232','848017250','848018000','848017887','848018206','848017797','848017809','848017753','848017265','848018363','848018010','848016900','848018871','848017786','848018595','848018422','848017003','848017600','848018561','848016987','511912860','8519531','8519920','8519966','8524135','8524250','8524630','8524676','8524694','8524843','8524959','8526416','8526577','8526814','8526850','8528034','8528195','8528441','8528812','8528830','8528937','8528946','8537388','8537546','8537591','8539492','8539854','8539960','8542308','8546003','8546331','8546368','8546836','8550459','8552086','8552998','8553067','8553164','8553359','8553702','8554136','8560997','8561163','8561473','8561543','8561880','8563064','8563143','8564124','8567130','8570596','8570860','8570930','8570967','8572521','8572646','8572664','8575768','8583819','8585002','8585589','8590590','8595753','8604307','8608659','848021350','848020670','848020960','848020853','848019746','848020998','848020953','848019247','848019801','848019615','848020713','848020705','848019522','848019681','848019503','848019566','848019581','848019574','848020740','848020747','848019379','848019996','848020609','848019846','848020777','848020768','848019548','848020439','848020397','848023764','848022626','848021809','848023536','848023332','848023204','848023350','848023324','848023208','848023149','848023157','848022179','848022831','848021729','848021930','848021923','848022303','848023283','848023279','848024553','848025225','848025161','848025184','848024584','848026182','848024711','848025879','848025859','848025418','848024841','848024792','848025576','848025390','848025374','848024813','848026217','848025985','848026060','848025021','848025146','848025761','848024286','848025817','848024821','848025805','848025651','848025819','848027430','848028747','848028753','848028640','848028555','848028070','848028591','848029440','848029437','848028470','848028135','848029707','848027176','848028786','848029550','848028828','848027145','848029948','848029873','848030117','848031657','848032204','848031906','848031751','848031744','848031758',
-- '848031739','848032277','848031811','848031866','848031861','848032777','848032004','848032767','848033163','848032745','848031574','848031276','848030614','848034763','848034205','848034836','848035860','848035997','848033879','848037283','848037299','848036467','848036448','848034942','848034680','848035313','848036646','848036027','848036597','848035903','848035362','848035370','848035703','848040793','848040048','848041141','848039361','848039647','848039637','848039465','848041011','848040539','848040544','848040546','848039700','848039691','848041053','848041043','848038504','848038490','848041108','848040041','848038194','848038196','848040748','848040811','848040408','848040138','848039733','848038125','848038101','848038098','848038683','848038376','848038282','848038279','848037781','848038018','848037773','848037784','848039196','848038915','848038931','848038859','848042551','848043901','848043912','848045282','848042233','848042512','848041744','848042783','848042776','848044933','848044923','848042774','848042758','848044111','848044144','848043816','848044219','848044217','848043786','848043025','848044159','848045140','848044962','848045101','848045107','848045205','848042136','848045208','848042135','848043697','848045226','848044330','848044620','848042667','848044646','848044742','848043384','848042286','848043760','848044684','848044841','848045550','848049885','848049102','848049888','848049111','848049332','848047925','848049974','848049297','848049649','848050044','848050075','848050093','848049554','848050141','848049776','848049765','848049720','848049829','848049705','848049085','848050201','848047747','848049060','848049064','848049051','848048709','848048071','848047502','848048976','848046223','848049489','848047697','848046246','848048003','848047824','848046024','848046295','848046339','848046952','848046151','848048188','848046519','848046716','848046705','848049350','848051835','848051448','848051441','848051464','848051458','848051067','848051064','848050550','848050918','848051656','848048465','848048468','848051374','848050600','848050626','848050616','848051558','848051161','848051543','848054674','848053680','848054756','848053887','848052604','848052208','848054712','848053654','848052805','848052944','848052318','848052682','848052308','848052836','848053761','848052544','848052354','848055294','848055296','848054938','848055042','848059258','848057373','848057742','848058510','848056941','848055788','848057275','848057264','848057238','848057343','848055637','848055774','848057147','848055856','848055865','848056879','848055726','848056095','848057726','848055562','848056413','848057827','848058596','848058608','848058179','848061453','848061692','848060241','848060243','848060258','848061155','848061587','848061558','848061884','848061882','848061245','848059956','848059554','848060413','848059551','848060414','848060398','848061831','848060811','848059901','848060319','848060092','848061940','9148978','9149029','9149551','9150520','9160448','511917343','511917824','511916499','511915976','511916059','511917102','511916290','511917488','511917245','511916905','848063077','848063085','848065222','848064866','848063835','848064798','848063280','848063944','848064128','848062923','848063241','848064893','848064283','848063429','848063565','848062820','848065061','848067654','848067911','848067876','848067416','848067237','848067247','848068426','848065826','848066794','848067182','848069304','848069310','848067220','848067207','848066990','848067005','848067008','848067001','848069321','848067004','848066889','848066345','848065900','848066759','848066771','848066767','848066758','848066762','848065880','848066772','848066757','848066226','848066243','848066208','848066252','848069043','848068655','848068853','848068866','848069181','848068864','848071812','848071815','848070224','848070670','848070234','848071559','848070493','848071451','848070478','848070221','848070506','848071435','848070537','848070211','848070664','848071432','848070439','848073385','848070948','848070891','848074055','848070875','848073742','848073700','848070615','848073698','848070625','848071797','848070621','848071708','848073911','848073462','848073816','848073801','848071742','848071185','848075784','848071745','848071631','848073861','848070533','848071191','848071275','848073936','848071005','848070338','848071040','848070460','848070545','848073345','848073554','848070765','848070266','848078457','848076312','848076261','848078916','848078757','848076467','848076483','848076480','848076485','848076484','848076471','848076606','848076594','848075715','848075718','848070792','848076576','848076551','848078529','848078286','848070588','848076891','848078620','848078629','848078642','848078647','848078640','848077278','848077284','848079651','848079746','848079647','848079649','848079646','848079639','848079757','848079733','848074787','848075468','848075494','848075278','848075478','848075471','848075270','848075269','848074879','848074884','848072437','848072450','848072430','848072255','848072428','848074854','848074867','848074846','848074837','848074836','848074856','848072491','848072507','848074092','848074096','848079425','848079407','848079427','848072367','848074948','848070541','848079318','848071857','848077706','848077690','848074262','848074255','848077689','848079478','848079230','848072184','848079074','848077025','848077985','848078124','848075663','848075664','848078109','848077180','848077192','848075549','848071987','848075619','848078352','848078221','848072701','848072698','848072722','848072707','848072710','848072720','848075381','848077819','848077835','848077790','848076024','848076419','848076035','848077927','848079009','848079023','848072635','848072610','848076081','848078249','848076749','848076734','848078235','848078242','848076733','848076247','848075569','848075585','848082160','848081156','848081141','848081150','848081142','848081739','848078157','848076660','848075235','848078231','848078473','848077610','848079759','848078480','848077585','848080808','848080811','848081285','848079959','848079982','848080396','848079958','848080039','848081019','848080328','848080584','848080567','848080864','848083651','848089894','848087718','848090565','848090556','848089456','848090851','848090773','848089854','848090226','848090083','848090090','848090771','848090786','848087650','848090622','848090499','848086745','848086310','848089773','848090386','848090392','848087767','848090811','848090350','848089925','848086197','848086935','848086362','848089437','848086620','848092123','848091978','848092255','848085404','848092267','848085851','848088430','848084958','848092500','848092480','848092353','848092475','848085525','848092468','848089022','848089011','848089024','848089010','848085356','848084779','848084769','848085615','848084798','848084800','848089282','848086069','848085983','848092020','848085643','848085646','848091486','848091461','848083934','848083328','848092062','848092086','848091091','848091314','848092043','848091938','848091800','848091799','848091813','848091812','848091814','848091775','848091809','848091793','848088662','848088689','848088676','848088677','848088942','848088466','848088784','848087556','848088147','848088137','848088133','848089225','848087830','848083153','848086410','848087221','848088092','848083814','848087906','848083418','848087892','848083444','848083309','848088093','848084159','848083728','848083587','848083994','848083735','848083738','511918868','848098258','848098131','848095034','848098108','848094530','848097668','848098096','848098613','848097810','848095013','848092795','848097605','848098519','848095226','848098838','848095330','848094290','848094017','848098295','848093543','848093524','848094032','848098528','848093453','848093412','848094118','848093694','848093902','848093894','848093477','848092830','848094231','848092834','848092848','848093227','848093237','848093229','848094097','848093573','848094318','848093971','848093984','848093993','848092924','848092921','848092918','848093043','848093346','848097485','848094822','848093051','848092755','848097332','848097345','848094636','848094591','848094577','848093933','848094502','848095866','848093004','848093329','848093333','848096742','848095856','848095839','848095837','848094477','848094449','848094448','848093835','848094367','848094364','848095560','848095580','848095565','848095568','848094839','848097399','848095940','848093510','848094707','848094701','848094693','848094708','848093504','848097272','848094706','848095273','848095283','848096807','848095191','848094928','848094933','848096110','848096983','848097144','848097195','848096520','848096287','848097249','848087332','848106900','511919072','511918522','511921703','511918671','511921944','511921466','511922558','511922546','511921260','511921213','511921216','848104575','848104584','848100671','848100898','848100880','848102551','848103730','848101760','848105326','848105342','848105323','848106061','848105329','848103891','848103824','848103842','848103897','848102845','848103519','848103480','848100063','848100064','848101030','848101043','848100186','848100857','848103008','848102124','848101484','848103587','848100831','848104163','848105234','848104969','848104963','848104958','848104904','848104416','848105315','848100354','848100958','848106279','848100073','848106301','848106282','848100947','848100074','848100075','848106306','848106299','848106307','848100952','848102103','848105835','848106134','848106128','848106135','848101898','848100099','848100586','848100602','848106385','848102259','848104844','848105875','848106079','848106082','848106092','848106084','848106075','848102150','848100151','511923747','511923607','511923499','511923677','511923342','511923333','511924261','511924625','511924789','511923859','511924703','511924385','511923954','511923953',
-- '848111395','848108863','848108181','848108171','848111608','848107570','848108906','848109221','848107788','848108572','848108758','848109146','848109122','848108150','848108505','848110551','848109849','848110425','848109789','848110311','848110293','848110447','848107017','511926607','511926573','511926585','511926760','511926777','511926828','848114751','848113846','848114038','848115776','848114381','848115912','848112273','848114289','848115513','848115616','848116298','848113196','1440126052','1440126624','1520185458','1520185473','1520185769','1520185857','1520185912','1520185924','1520185928','1520185947','1520185992','1520186037','1520186362','1520186557','1520186608','1520186691','1520186782','1520186816','1520186908','1520186987','1520187108','1520187121','1520187152','1520187543','1520187941','1520188053','1520188448','1520188523','1520188532','1520188537','1520188540','1520188677','1520189359','1520189608','1520189635','1520189886','1520189914','1520189945','1520190154','1520190284','1520190297','1520191069','1520191585','1520191665','1520191870','1520191894','1520191906','1520191959','1520192002','1520192194','1520192497','1520192529','1520192547','1520192618','1520192783','1520192792','1520192827','1520192860','1520193019','1520193020','1520193036','1520193113','1520193210','1520193263','1520193282','1520193355','1520193433','1520193580','1520193671','1520193700','1520193707','1520193831','1520193904','1520193942','1520194066','1520194380','1520194430','1520194432','1520194446','1520194730','1520194747','1520194769','1520194829','1520194895','1520194974','1520195010','1520195116','1520195214','1520195256','1520195340','1520195347','1520195416','1520195590','1520195620','1520195636','1520195741','1520195886','1520195891','1520195951','1520195983','1520196034','1520196073','1520196152','1520196158','1520196162','1520196438','1520196442','1520196461','1520196529','1520196558','1520196592','1520196699','1520196791','1520196907','1520196908','1520197067','1520197155','1520197196','1520197260','1520197265','1520197434','1520197538','1520197542','1520197594','1520197613','1520197655','1520197664','1520197812','1520197928','1520197957','1520198015','1520198026','1520198145','1520198153','1520198278','1520198307','1520198434','1520198461','1520199137','1520199492','1520199837','1520200012','1520200478','1520200925','1520201461','1520201514','1520201519','1520201570','1520201620','1520201631','1520201948','1520202131','1520202171','1520202198','1520202241','1520202353','1520202398','1520202436','1520202520','1520202584','1520202592','1520202910','1520202977','1520203004','1520203129','1520203232','1520203246','1520203265','1520203268','1520203444','1520203446','1520203673','1520203705','1520203871','1520203914','1520203991','1520204011','1520204334','1520204476','1520204892','1520205200','1520205265','1520205326','1520205487','1520205490','1520205722','1520205735','1520205744','1520205946','1520205974','1520206041','1520206097','1520206098','1520206108','1520206195','1520206498','1520206507','1520206511','1520206662','1520206725','1520206806','1520206812','1520206850','1520206851','1520206882','1520207364','1520207375','1520207461','1520207814','1520207891','1520208086','1520208174','1520208322','1520208384','1520208443','1520208551','1520208611','1520208698','1520208895','1520208954','1520208966','1520208987','1520209138','1520209150','1520209229','1520209239','1520209335','1520209373','1520209505','1520209530','1520209537','1520209555','1520209663','1520209683','1520209749','1520209750','1520209760','1520209902','1520209967','1520210142','1520210313','1520210324','1520210367','1520210375','1520210490','1520210499','1520210505','1520210602','1520210670','1520210729','1520210806','1520210824','1520210917','1520210952','1520211027','1520211030','1520211102','1520211113','1520211124','1520211186','1520211250','1520211292','1520211320','1520211327','1520211582','1520211586','1520211695','1520211707','1520211867','1520211871','1520211954','1520212028','1520212033','1520212254','1520212259','1520212283','1520212338','1520212412','1520212424','1520212434','1520212539','1520212764','1520212777','1520212883','1520212948','1520212952','1520212985','1520213022','1520213104','1520213155','1520213248','1520213249','1520213296','1520213364','1520213466','1520213846','1520213861','1520213871','1520213943','1520214294','1520214373','1520214396','1520214578','1520214798','1520214863','1520214944','1520215000','1520215109','1520215125','1520215144','1520215244','1520215266','1520215306','1520215395','1520215402','1520215486','1520215580','1520215583','1520215606','1520215609','1520215680','1520216117','1520216171','1520216810','1520216842','1520216991','1520217160','1520217201','1520217213','1520217215','1520217219','1520217224','1520217354','1520217355','1520217382','1520217384','1520217414','1520217661','1520217681','1520217713','1520217796','1520217798','1520217991','1520218138','1520218222','1520218232','1520218246','1520218394','1520218421','1520218523','1520218721','1520218812','1520218825','1520218845','1520219008','1520219024','1520219174','1520219267','1520219335','1520219398','1520219433','1520219466','1520219532','1520219564','1520219602','1520219613','1520219614','1520219616','1520219665','1520219704','1520219784','1520219812','1520219815','1520219885','1520219899','1520219900','1520219955','1520219966','1520219982','1520219996','1520220065','1520220103','1520220120','1520220144','1520220174','1520220242','1520220245','1520220259','1520220340','1520220393','1520220444','1520220449','1520220454','1520220473','1520220665','1520220696','1520220839','1520220864','1520221009','1520221039','1520221106','1520221283','1520221307','1520221368','1520221448','1520221750','1520222633','1520223183','1520223192','1520223428','1520224064','1520224150','1520224359','1520224801','1520224849','1520224882','1520224905','1520224919','1520225099','1520225240'
